// Generated by CoffeeScript 1.7.1
(function() {
  var Lock, lock, tm1;

  require.config({
    baseUrl: '/'
  });

  tm1 = +new Date();

  window.tm = function(name) {
    return console.log('time', name, new Date() - tm1);
  };

  Lock = (function() {
    function Lock() {
      this.count = 0;
    }

    Lock.prototype.await = function(f) {
      this.count++;
      return f((function(_this) {
        return function() {
          if (!--_this.count) {
            return typeof _this.defer === "function" ? _this.defer() : void 0;
          }
        };
      })(this));
    };

    return Lock;

  })();

  lock = new Lock();

  lock.await(function(cb) {
    return require(['vendor/underscore'], function() {
      return require(['vendor/backbone'], function() {
        return require(['lib/backbone-socketio'], cb);
      });
    });
  });

  lock.await(function(cb) {
    return require(['vendor/zepto', 'socket.io/socket.io'], cb);
  });

  lock.defer = function() {
    tm('defer');
    if (!window.app) {
      window.app = {};
    }
    return require(['lib/models', 'lib/router', 'lib/views/app'], function(Models, Router, AppView) {
      return $(function() {
        app.Clients = new Models.ClientList;
        app.Projects = new Models.ProjectList(null, {
          clients: app.Clients
        });
        app.router = new Router;
        app.app = new AppView;
        $('#page_loader').remove();
        return app.app.launch();
      });
    });
  };

}).call(this);
